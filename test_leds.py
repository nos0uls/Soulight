"""
replay_red_loop.py
==================
Отправляет handshake один раз, затем бесконечно зацикливает красный цвет.
Никакого белого мерцания - только чистый красный.

python replay_red_loop.py
"""
import serial, time

PORT = "COM7"
BAUDRATE = 500000

HANDSHAKE = [
    bytes.fromhex("55aa5a0c00"),
    bytes.fromhex("4c390a3a60ec0005c8710a3b"),
    bytes.fromhex("55aa5a0e00"),
    bytes.fromhex("213b9db8b6ffcd2a4cde92d29dba"),
    bytes.fromhex("55aa5a1300"),
    bytes.fromhex("1e3b9db8b6ffcd2a4cde92d29dbdb700cc2a4d"),
    bytes.fromhex("55aa5a0d00"),
    bytes.fromhex("c33898d5d8bdc6fee194e298d6"),
    bytes.fromhex("55aa5a0c00"),
    bytes.fromhex("cb398c263346d7394b5b8c25"),
    bytes.fromhex("55aa5a0a00"),
    bytes.fromhex("873759f6410c1d4959f5"),
    bytes.fromhex("55aa5a0e00"),
    bytes.fromhex("d43be1861e25222ca936f864e185"),
    bytes.fromhex("55aa5a0700"),
    bytes.fromhex("92326be1c76be2"),
    bytes.fromhex("55aa5a0d00"),
    bytes.fromhex("fd38250e533c31ee91b968240e"),
    bytes.fromhex("55aa5a0a00"),
    bytes.fromhex("0d3771d280db768070d2"),
    bytes.fromhex("55aa5a0a00"),
    bytes.fromhex("0d3771d280db768070d2"),
    bytes.fromhex("55aa5a0a00"),
    bytes.fromhex("0d3771d280db768070d2"),
    bytes.fromhex("55aa5af400"),
]

# Один цикл красного цвета (пакеты 24-115 из лога)
# 92 пакетов = один полный суперкадр
RED_CYCLE = [
    bytes.fromhex("55aa5af400"),
    bytes.fromhex("9a388c1739f1652c6ea5ca8c123c0e862c25a5ca8c1739f1652c6ea5ca8c1739f1652c6ea5ca8c1739f1652c6ea5ca8c1739f1652c6ea5ca8c1739f1652c6ea5ca8c1739f1652c6ea5ca8c1739f1652c6ea5ca8c1739f1652c6ea5ca8c1739f1652c6ea5ca8c1739f1652c6ea5ca8c1739f1652c6ea5ca8c1739f1652c6ea5ca8c1739f1652c6ea5ca8c1739f1652c6ea5ca8c1739f1652c6ea5ca8c1739f1652c6ea5ca8c1739f1652c6ea5ca8c1739f1652c6ea5ca8c1739f1652c6ea5ca8c1739f1652c6ea5ca8c1739f1652c6ea5ca8c1739f1652c6ea5ca8c1739f1652c6ea5ca8c1739f1652c6ea5ca8c1739f1652c6ea5"),
    bytes.fromhex("55aa5aee00"),
    bytes.fromhex("1b329ca21e9ca71b63411ed7a21e9ca21e9ca21e9ca21e9ca21e9ca21e9ca21e9ca21e9ca21e9ca21e9ca21e9ca21e9ca21e9ca21e9ca21e9ca21e9ca21e9ca21e9ca21e9ca21e9ca21e9ca21e9ca21e9ca21e9ca21e9ca21e9ca21e9ca21e9ca21e9ca21e9ca21e9ca21e9ca21e9ca21e9ca21e9ca21e9ca21e9ca21e9ca21e9ca21e9ca21e9ca21e9ca21e9ca21e9ca21e9ca21e9ca21e9ca21e9ca21e9ca21e9ca21e9ca21e9ca21e9ca21e9ca21e9ca21e9ca21e9ca21e9ca21e9ca21e9ca21e9ca21e9ca21e9ca21e9ca21e9ca21e9ca21e9ca21e9ca21e9ca21e9ca21e9ca21e9ca21e9ca21e9ca21e9ca2"),
    bytes.fromhex("55aa5aee00"),
    bytes.fromhex("333298c21398c716672113d3c21398c21398c21398c21398c21398c21398c21398c21398c21398c21398c21398c21398c21398c21398c21398c21398c21398c21398c21398c21398c21398c21398c21398c21398c21398c21398c21398c21398c21398c21398c21398c21398c21398c21398c21398c21398c21398c21398c21398c21398c21398c21398c21398c21398c21398c21398c21398c21398c21398c21398c21398c21398c21398c21398c21398c21398c21398c21398c21398c21398c21398c21398c21398c21398c21398c21398c21398c21398c21398c21398c21398c21398c21398c21398c21398c2"),
    bytes.fromhex("55aa5af300"),
    bytes.fromhex("8b390182521ec154f498018757e12254bf980182521ec154f4980182521ec154f4980182521ec154f4980182521ec154f4980182521ec154f4980182521ec154f4980182521ec154f4980182521ec154f4980182521ec154f4980182521ec154f4980182521ec154f4980182521ec154f4980182521ec154f4980182521ec154f4980182521ec154f4980182521ec154f4980182521ec154f4980182521ec154f4980182521ec154f4980182521ec154f4980182521ec154f4980182521ec154f4980182521ec154f4980182521ec154f4980182521ec154f4980182521ec154f4980182521ec154f4980182521ec154f49801"),
    bytes.fromhex("55aa5af000"),
    bytes.fromhex("bf34f77d3047b9f77835b85af7363047b9f77d3047b9f77d3047b9f77d3047b9f77d3047b9f77d3047b9f77d3047b9f77d3047b9f77d3047b9f77d3047b9f77d3047b9f77d3047b9f77d3047b9f77d3047b9f77d3047b9f77d3047b9f77d3047b9f77d3047b9f77d3047b9f77d3047b9f77d3047b9f77d3047b9f77d3047b9f77d3047b9f77d3047b9f77d3047b9f77d3047b9f77d3047b9f77d3047b9f77d3047b9f77d3047b9f77d3047b9f77d3047b9f77d3047b9f77d3047b9f77d3047b9f77d3047b9f77d3047b9f77d3047b9f77d3047b9f77d3047b9f77d3047b9f77d3047b9f77d3047b9f77d3047b9f77d30"),
    bytes.fromhex("55aa5af100"),
    bytes.fromhex("57375bf3e948d80d5bf6ecb73b0d10f3e948d80d5bf3e948d80d5bf3e948d80d5bf3e948d80d5bf3e948d80d5bf3e948d80d5bf3e948d80d5bf3e948d80d5bf3e948d80d5bf3e948d80d5bf3e948d80d5bf3e948d80d5bf3e948d80d5bf3e948d80d5bf3e948d80d5bf3e948d80d5bf3e948d80d5bf3e948d80d5bf3e948d80d5bf3e948d80d5bf3e948d80d5bf3e948d80d5bf3e948d80d5bf3e948d80d5bf3e948d80d5bf3e948d80d5bf3e948d80d5bf3e948d80d5bf3e948d80d5bf3e948d80d5bf3e948d80d5bf3e948d80d5bf3e948d80d5bf3e948d80d5bf3e948d80d5bf3e948d80d5bf3e948d80d5bf3e948d8"),
    bytes.fromhex("55aa5af100"),
    bytes.fromhex("84378b4a27e403948b4f221be094c04a27e403948b4a27e403948b4a27e403948b4a27e403948b4a27e403948b4a27e403948b4a27e403948b4a27e403948b4a27e403948b4a27e403948b4a27e403948b4a27e403948b4a27e403948b4a27e403948b4a27e403948b4a27e403948b4a27e403948b4a27e403948b4a27e403948b4a27e403948b4a27e403948b4a27e403948b4a27e403948b4a27e403948b4a27e403948b4a27e403948b4a27e403948b4a27e403948b4a27e403948b4a27e403948b4a27e403948b4a27e403948b4a27e403948b4a27e403948b4a27e403948b4a27e403948b4a27e403948b4a27e403"),
    bytes.fromhex("55aa5aee00"),
    bytes.fromhex("eb32bf27dabf22df40c4daf427dabf27dabf27dabf27dabf27dabf27dabf27dabf27dabf27dabf27dabf27dabf27dabf27dabf27dabf27dabf27dabf27dabf27dabf27dabf27dabf27dabf27dabf27dabf27dabf27dabf27dabf27dabf27dabf27dabf27dabf27dabf27dabf27dabf27dabf27dabf27dabf27dabf27dabf27dabf27dabf27dabf27dabf27dabf27dabf27dabf27dabf27dabf27dabf27dabf27dabf27dabf27dabf27dabf27dabf27dabf27dabf27dabf27dabf27dabf27dabf27dabf27dabf27dabf27dabf27dabf27dabf27dabf27dabf27dabf27dabf27dabf27dabf27dabf27dabf27dabf27"),
    bytes.fromhex("55aa5af300"),
    bytes.fromhex("4f3921dd33eb8f8df66d21d836146c8dbd6d21dd33eb8f8df66d21dd33eb8f8df66d21dd33eb8f8df66d21dd33eb8f8df66d21dd33eb8f8df66d21dd33eb8f8df66d21dd33eb8f8df66d21dd33eb8f8df66d21dd33eb8f8df66d21dd33eb8f8df66d21dd33eb8f8df66d21dd33eb8f8df66d21dd33eb8f8df66d21dd33eb8f8df66d21dd33eb8f8df66d21dd33eb8f8df66d21dd33eb8f8df66d21dd33eb8f8df66d21dd33eb8f8df66d21dd33eb8f8df66d21dd33eb8f8df66d21dd33eb8f8df66d21dd33eb8f8df66d21dd33eb8f8df66d21dd33eb8f8df66d21dd33eb8f8df66d21dd33eb8f8df66d21dd33eb8f8df66d21"),
    bytes.fromhex("55aa5af300"),
    bytes.fromhex("393989cfe88c2ccfc1c689caed73cfcf8ac689cfe88c2ccfc1c689cfe88c2ccfc1c689cfe88c2ccfc1c689cfe88c2ccfc1c689cfe88c2ccfc1c689cfe88c2ccfc1c689cfe88c2ccfc1c689cfe88c2ccfc1c689cfe88c2ccfc1c689cfe88c2ccfc1c689cfe88c2ccfc1c689cfe88c2ccfc1c689cfe88c2ccfc1c689cfe88c2ccfc1c689cfe88c2ccfc1c689cfe88c2ccfc1c689cfe88c2ccfc1c689cfe88c2ccfc1c689cfe88c2ccfc1c689cfe88c2ccfc1c689cfe88c2ccfc1c689cfe88c2ccfc1c689cfe88c2ccfc1c689cfe88c2ccfc1c689cfe88c2ccfc1c689cfe88c2ccfc1c689cfe88c2ccfc1c689cfe88c2ccfc1c689"),
    bytes.fromhex("55aa5aef00"),
    bytes.fromhex("8935543cc9725439cc8db73c8272543cc972543cc972543cc972543cc972543cc972543cc972543cc972543cc972543cc972543cc972543cc972543cc972543cc972543cc972543cc972543cc972543cc972543cc972543cc972543cc972543cc972543cc972543cc972543cc972543cc972543cc972543cc972543cc972543cc972543cc972543cc972543cc972543cc972543cc972543cc972543cc972543cc972543cc972543cc972543cc972543cc972543cc972543cc972543cc972543cc972543cc972543cc972543cc972543cc972543cc972543cc972543cc972543cc972543cc972543cc972543cc97254"),
    bytes.fromhex("55aa5af300"),
    bytes.fromhex("eb39e5dcfa8e39890887e5d9ff71da894387e5dcfa8e39890887e5dcfa8e39890887e5dcfa8e39890887e5dcfa8e39890887e5dcfa8e39890887e5dcfa8e39890887e5dcfa8e39890887e5dcfa8e39890887e5dcfa8e39890887e5dcfa8e39890887e5dcfa8e39890887e5dcfa8e39890887e5dcfa8e39890887e5dcfa8e39890887e5dcfa8e39890887e5dcfa8e39890887e5dcfa8e39890887e5dcfa8e39890887e5dcfa8e39890887e5dcfa8e39890887e5dcfa8e39890887e5dcfa8e39890887e5dcfa8e39890887e5dcfa8e39890887e5dcfa8e39890887e5dcfa8e39890887e5dcfa8e39890887e5dcfa8e39890887e5"),
    bytes.fromhex("55aa5af100"),
    bytes.fromhex("fb37e1ab1d40912be1ae18bf722baaab1d40912be1ab1d40912be1ab1d40912be1ab1d40912be1ab1d40912be1ab1d40912be1ab1d40912be1ab1d40912be1ab1d40912be1ab1d40912be1ab1d40912be1ab1d40912be1ab1d40912be1ab1d40912be1ab1d40912be1ab1d40912be1ab1d40912be1ab1d40912be1ab1d40912be1ab1d40912be1ab1d40912be1ab1d40912be1ab1d40912be1ab1d40912be1ab1d40912be1ab1d40912be1ab1d40912be1ab1d40912be1ab1d40912be1ab1d40912be1ab1d40912be1ab1d40912be1ab1d40912be1ab1d40912be1ab1d40912be1ab1d40912be1ab1d40912be1ab1d4091"),
    bytes.fromhex("55aa5af200"),
    bytes.fromhex("5b362991661799376a299463e87a37212991661799376a2991661799376a2991661799376a2991661799376a2991661799376a2991661799376a2991661799376a2991661799376a2991661799376a2991661799376a2991661799376a2991661799376a2991661799376a2991661799376a2991661799376a2991661799376a2991661799376a2991661799376a2991661799376a2991661799376a2991661799376a2991661799376a2991661799376a2991661799376a2991661799376a2991661799376a2991661799376a2991661799376a2991661799376a2991661799376a2991661799376a2991661799376a2991"),
    bytes.fromhex("55aa5af300"),
    bytes.fromhex("fa39d25339f33180c06cd2563c0cd2808b6cd25339f33180c06cd25339f33180c06cd25339f33180c06cd25339f33180c06cd25339f33180c06cd25339f33180c06cd25339f33180c06cd25339f33180c06cd25339f33180c06cd25339f33180c06cd25339f33180c06cd25339f33180c06cd25339f33180c06cd25339f33180c06cd25339f33180c06cd25339f33180c06cd25339f33180c06cd25339f33180c06cd25339f33180c06cd25339f33180c06cd25339f33180c06cd25339f33180c06cd25339f33180c06cd25339f33180c06cd25339f33180c06cd25339f33180c06cd25339f33180c06cd25339f33180c06cd2"),
    bytes.fromhex("55aa5af500"),
    bytes.fromhex("ff3bd3312f550e5cfe611680d3342aaaed5cb5611680d3312f550e5cfe611680d3312f550e5cfe611680d3312f550e5cfe611680d3312f550e5cfe611680d3312f550e5cfe611680d3312f550e5cfe611680d3312f550e5cfe611680d3312f550e5cfe611680d3312f550e5cfe611680d3312f550e5cfe611680d3312f550e5cfe611680d3312f550e5cfe611680d3312f550e5cfe611680d3312f550e5cfe611680d3312f550e5cfe611680d3312f550e5cfe611680d3312f550e5cfe611680d3312f550e5cfe611680d3312f550e5cfe611680d3312f550e5cfe611680d3312f550e5cfe611680d3312f550e5cfe611680d3312f"),
    bytes.fromhex("55aa5af200"),
    bytes.fromhex("5736ec3cb7d3df2b3dec39b22c3c2b76ec3cb7d3df2b3dec3cb7d3df2b3dec3cb7d3df2b3dec3cb7d3df2b3dec3cb7d3df2b3dec3cb7d3df2b3dec3cb7d3df2b3dec3cb7d3df2b3dec3cb7d3df2b3dec3cb7d3df2b3dec3cb7d3df2b3dec3cb7d3df2b3dec3cb7d3df2b3dec3cb7d3df2b3dec3cb7d3df2b3dec3cb7d3df2b3dec3cb7d3df2b3dec3cb7d3df2b3dec3cb7d3df2b3dec3cb7d3df2b3dec3cb7d3df2b3dec3cb7d3df2b3dec3cb7d3df2b3dec3cb7d3df2b3dec3cb7d3df2b3dec3cb7d3df2b3dec3cb7d3df2b3dec3cb7d3df2b3dec3cb7d3df2b3dec3cb7d3df2b3dec3cb7d3df2b3dec3cb7d3df2b3dec3c"),
    bytes.fromhex("55aa5af100"),
    bytes.fromhex("0837f6ada5213b56f6a8a0ded856bdada5213b56f6ada5213b56f6ada5213b56f6ada5213b56f6ada5213b56f6ada5213b56f6ada5213b56f6ada5213b56f6ada5213b56f6ada5213b56f6ada5213b56f6ada5213b56f6ada5213b56f6ada5213b56f6ada5213b56f6ada5213b56f6ada5213b56f6ada5213b56f6ada5213b56f6ada5213b56f6ada5213b56f6ada5213b56f6ada5213b56f6ada5213b56f6ada5213b56f6ada5213b56f6ada5213b56f6ada5213b56f6ada5213b56f6ada5213b56f6ada5213b56f6ada5213b56f6ada5213b56f6ada5213b56f6ada5213b56f6ada5213b56f6ada5213b56f6ada5213b"),
    bytes.fromhex("55aa5af000"),
    bytes.fromhex("6f343348c34026334dc6bfc53303c340263348c340263348c340263348c340263348c340263348c340263348c340263348c340263348c340263348c340263348c340263348c340263348c340263348c340263348c340263348c340263348c340263348c340263348c340263348c340263348c340263348c340263348c340263348c340263348c340263348c340263348c340263348c340263348c340263348c340263348c340263348c340263348c340263348c340263348c340263348c340263348c340263348c340263348c340263348c340263348c340263348c340263348c340263348c340263348c340263348c3"),
    bytes.fromhex("55aa5aef00"),
    bytes.fromhex("7135e1aba2e2e1aea71d02abe9e2e1aba2e2e1aba2e2e1aba2e2e1aba2e2e1aba2e2e1aba2e2e1aba2e2e1aba2e2e1aba2e2e1aba2e2e1aba2e2e1aba2e2e1aba2e2e1aba2e2e1aba2e2e1aba2e2e1aba2e2e1aba2e2e1aba2e2e1aba2e2e1aba2e2e1aba2e2e1aba2e2e1aba2e2e1aba2e2e1aba2e2e1aba2e2e1aba2e2e1aba2e2e1aba2e2e1aba2e2e1aba2e2e1aba2e2e1aba2e2e1aba2e2e1aba2e2e1aba2e2e1aba2e2e1aba2e2e1aba2e2e1aba2e2e1aba2e2e1aba2e2e1aba2e2e1aba2e2e1aba2e2e1aba2e2e1aba2e2e1aba2e2e1aba2e2e1aba2e2e1aba2e2e1aba2e2e1aba2e2e1aba2e2e1aba2e2e1"),
    bytes.fromhex("55aa5a0900"),
    bytes.fromhex("b934597897d673597b"),
    bytes.fromhex("55aa5af000"),
    bytes.fromhex("4634597897d673597d922990593397d673597897d673597897d673597897d673597897d673597897d673597897d673597897d673597897d673597897d673597897d673597897d673597897d673597897d673597897d673597897d673597897d673597897d673597897d673597897d673597897d673597897d673597897d673597897d673597897d673597897d673597897d673597897d673597897d673597897d673597897d673597897d673597897d673597897d673597897d673597897d673597897d673597897d673597897d673597897d673597897d673597897d673597897d673597897d673597897d673597897"),
    bytes.fromhex("55aa5a1100"),
    bytes.fromhex("373676de7106ca2fd676db73f9c82f3e75"),
    bytes.fromhex("55aa5a0b00"),
    bytes.fromhex("223676de7106ca2fd676dc"),
    bytes.fromhex("55aa5aef00"),
    bytes.fromhex("6635b8218318b82486e75b21c818b8218318b8218318b8218318b8218318b8218318b8218318b8218318b8218318b8218318b8218318b8218318b8218318b8218318b8218318b8218318b8218318b8218318b8218318b8218318b8218318b8218318b8218318b8218318b8218318b8218318b8218318b8218318b8218318b8218318b8218318b8218318b8218318b8218318b8218318b8218318b8218318b8218318b8218318b8218318b8218318b8218318b8218318b8218318b8218318b8218318b8218318b8218318b8218318b8218318b8218318b8218318b8218318b8218318b8218318b8218318b8218318b8"),
    bytes.fromhex("55aa5af500"),
    bytes.fromhex("993b9656f5de16961c5bdf169653f021f596575bdf169656f5de16961c5bdf169656f5de16961c5bdf169656f5de16961c5bdf169656f5de16961c5bdf169656f5de16961c5bdf169656f5de16961c5bdf169656f5de16961c5bdf169656f5de16961c5bdf169656f5de16961c5bdf169656f5de16961c5bdf169656f5de16961c5bdf169656f5de16961c5bdf169656f5de16961c5bdf169656f5de16961c5bdf169656f5de16961c5bdf169656f5de16961c5bdf169656f5de16961c5bdf169656f5de16961c5bdf169656f5de16961c5bdf169656f5de16961c5bdf169656f5de16961c5bdf169656f5de16961c5bdf169656f5"),
    bytes.fromhex("55aa5af500"),
    bytes.fromhex("b73b44913aed123dd122118244943f12f13d9a22118244913aed123dd122118244913aed123dd122118244913aed123dd122118244913aed123dd122118244913aed123dd122118244913aed123dd122118244913aed123dd122118244913aed123dd122118244913aed123dd122118244913aed123dd122118244913aed123dd122118244913aed123dd122118244913aed123dd122118244913aed123dd122118244913aed123dd122118244913aed123dd122118244913aed123dd122118244913aed123dd122118244913aed123dd122118244913aed123dd122118244913aed123dd122118244913aed123dd122118244913a"),
    bytes.fromhex("55aa5a0d00"),
    bytes.fromhex("73351623da8c1626db731723db"),
    bytes.fromhex("55aa5aef00"),
    bytes.fromhex("e2353f8959383f8c5cc7dc8912383f8959383f8959383f8959383f8959383f8959383f8959383f8959383f8959383f8959383f8959383f8959383f8959383f8959383f8959383f8959383f8959383f8959383f8959383f8959383f8959383f8959383f8959383f8959383f8959383f8959383f8959383f8959383f8959383f8959383f8959383f8959383f8959383f8959383f8959383f8959383f8959383f8959383f8959383f8959383f8959383f8959383f8959383f8959383f8959383f8959383f8959383f8959383f8959383f8959383f8959383f8959383f8959383f8959383f8959383f8959383f8959383f"),
    bytes.fromhex("55aa5a0a00"),
    bytes.fromhex("3d37f9f65a5ca9cbf9f4"),
    bytes.fromhex("55aa5a1200"),
    bytes.fromhex("5736f71db61a8a4beef718b0e5894beef71d"),
    bytes.fromhex("55aa5a1200"),
    bytes.fromhex("1c36f71db61a8a4beef718b0e5894beef6e3"),
    bytes.fromhex("55aa5a0800"),
    bytes.fromhex("ca352610cd5b2710"),
    bytes.fromhex("55aa5a0700"),
    bytes.fromhex("b132c5ee1bc5ec"),
    bytes.fromhex("55aa5af300"),
    bytes.fromhex("7839769ff603ed595fbc769af3fc0e5914bc769ff603ed595fbc769ff603ed595fbc769ff603ed595fbc769ff603ed595fbc769ff603ed595fbc769ff603ed595fbc769ff603ed595fbc769ff603ed595fbc769ff603ed595fbc769ff603ed595fbc769ff603ed595fbc769ff603ed595fbc769ff603ed595fbc769ff603ed595fbc769ff603ed595fbc769ff603ed595fbc769ff603ed595fbc769ff603ed595fbc769ff603ed595fbc769ff603ed595fbc769ff603ed595fbc769ff603ed595fbc769ff603ed595fbc769ff603ed595fbc769ff603ed595fbc769ff603ed595fbc769ff603ed595fbc769ff603ed595fbc76"),
    bytes.fromhex("55aa5af100"),
    bytes.fromhex("b237b84ed2972300b84bd768c000f34ed2972300b84ed2972300b84ed2972300b84ed2972300b84ed2972300b84ed2972300b84ed2972300b84ed2972300b84ed2972300b84ed2972300b84ed2972300b84ed2972300b84ed2972300b84ed2972300b84ed2972300b84ed2972300b84ed2972300b84ed2972300b84ed2972300b84ed2972300b84ed2972300b84ed2972300b84ed2972300b84ed2972300b84ed2972300b84ed2972300b84ed2972300b84ed2972300b84ed2972300b84ed2972300b84ed2972300b84ed2972300b84ed2972300b84ed2972300b84ed2972300b84ed2972300b84ed2972300b84ed29723"),
    bytes.fromhex("55aa5a1400"),
    bytes.fromhex("c1381172f8af6e6f750d671177fe506d6f750c66"),
    bytes.fromhex("55aa5a0d00"),
    bytes.fromhex("a9381172f8af6e6f750d671170"),
    bytes.fromhex("55aa5af200"),
    bytes.fromhex("4636b73c559ca004a1b73950634304eab73c559ca004a1b73c559ca004a1b73c559ca004a1b73c559ca004a1b73c559ca004a1b73c559ca004a1b73c559ca004a1b73c559ca004a1b73c559ca004a1b73c559ca004a1b73c559ca004a1b73c559ca004a1b73c559ca004a1b73c559ca004a1b73c559ca004a1b73c559ca004a1b73c559ca004a1b73c559ca004a1b73c559ca004a1b73c559ca004a1b73c559ca004a1b73c559ca004a1b73c559ca004a1b73c559ca004a1b73c559ca004a1b73c559ca004a1b73c559ca004a1b73c559ca004a1b73c559ca004a1b73c559ca004a1b73c559ca004a1b73c559ca004a1b73c"),
    bytes.fromhex("55aa5af400"),
    bytes.fromhex("c73879edf66663f98a20ec79e8f39980f9c120ec79edf66663f98a20ec79edf66663f98a20ec79edf66663f98a20ec79edf66663f98a20ec79edf66663f98a20ec79edf66663f98a20ec79edf66663f98a20ec79edf66663f98a20ec79edf66663f98a20ec79edf66663f98a20ec79edf66663f98a20ec79edf66663f98a20ec79edf66663f98a20ec79edf66663f98a20ec79edf66663f98a20ec79edf66663f98a20ec79edf66663f98a20ec79edf66663f98a20ec79edf66663f98a20ec79edf66663f98a20ec79edf66663f98a20ec79edf66663f98a20ec79edf66663f98a20ec79edf66663f98a20ec79edf66663f98a20"),
    bytes.fromhex("55aa5aee00"),
    bytes.fromhex("013260b0bf60b5ba9f53bf2bb0bf60b0bf60b0bf60b0bf60b0bf60b0bf60b0bf60b0bf60b0bf60b0bf60b0bf60b0bf60b0bf60b0bf60b0bf60b0bf60b0bf60b0bf60b0bf60b0bf60b0bf60b0bf60b0bf60b0bf60b0bf60b0bf60b0bf60b0bf60b0bf60b0bf60b0bf60b0bf60b0bf60b0bf60b0bf60b0bf60b0bf60b0bf60b0bf60b0bf60b0bf60b0bf60b0bf60b0bf60b0bf60b0bf60b0bf60b0bf60b0bf60b0bf60b0bf60b0bf60b0bf60b0bf60b0bf60b0bf60b0bf60b0bf60b0bf60b0bf60b0bf60b0bf60b0bf60b0bf60b0bf60b0bf60b0bf60b0bf60b0bf60b0bf60b0bf60b0bf60b0bf60b0bf60b0bf60b0"),
    bytes.fromhex("55aa5af100"),
    bytes.fromhex("fc37c69b5a2ebf9ac69e5fd15c9a8d9b5a2ebf9ac69b5a2ebf9ac69b5a2ebf9ac69b5a2ebf9ac69b5a2ebf9ac69b5a2ebf9ac69b5a2ebf9ac69b5a2ebf9ac69b5a2ebf9ac69b5a2ebf9ac69b5a2ebf9ac69b5a2ebf9ac69b5a2ebf9ac69b5a2ebf9ac69b5a2ebf9ac69b5a2ebf9ac69b5a2ebf9ac69b5a2ebf9ac69b5a2ebf9ac69b5a2ebf9ac69b5a2ebf9ac69b5a2ebf9ac69b5a2ebf9ac69b5a2ebf9ac69b5a2ebf9ac69b5a2ebf9ac69b5a2ebf9ac69b5a2ebf9ac69b5a2ebf9ac69b5a2ebf9ac69b5a2ebf9ac69b5a2ebf9ac69b5a2ebf9ac69b5a2ebf9ac69b5a2ebf9ac69b5a2ebf9ac69b5a2ebf9ac69b5a2ebf"),
    bytes.fromhex("55aa5a0f00"),
    bytes.fromhex("743566c821e366cd271c65c821e267"),
    bytes.fromhex("55aa5af000"),
    bytes.fromhex("a334d0e4601de3d0e165e200d0af601de3d0e4601de3d0e4601de3d0e4601de3d0e4601de3d0e4601de3d0e4601de3d0e4601de3d0e4601de3d0e4601de3d0e4601de3d0e4601de3d0e4601de3d0e4601de3d0e4601de3d0e4601de3d0e4601de3d0e4601de3d0e4601de3d0e4601de3d0e4601de3d0e4601de3d0e4601de3d0e4601de3d0e4601de3d0e4601de3d0e4601de3d0e4601de3d0e4601de3d0e4601de3d0e4601de3d0e4601de3d0e4601de3d0e4601de3d0e4601de3d0e4601de3d0e4601de3d0e4601de3d0e4601de3d0e4601de3d0e4601de3d0e4601de3d0e4601de3d0e4601de3d0e4601de3d0e460"),
    bytes.fromhex("55aa5af100"),
    bytes.fromhex("63371a08877e88f11a0d82816bf15108877e88f11a08877e88f11a08877e88f11a08877e88f11a08877e88f11a08877e88f11a08877e88f11a08877e88f11a08877e88f11a08877e88f11a08877e88f11a08877e88f11a08877e88f11a08877e88f11a08877e88f11a08877e88f11a08877e88f11a08877e88f11a08877e88f11a08877e88f11a08877e88f11a08877e88f11a08877e88f11a08877e88f11a08877e88f11a08877e88f11a08877e88f11a08877e88f11a08877e88f11a08877e88f11a08877e88f11a08877e88f11a08877e88f11a08877e88f11a08877e88f11a08877e88f11a08877e88f11a08877e88"),
    bytes.fromhex("55aa5af000"),
    bytes.fromhex("6534d5924c41a5d59749be46d5d94c41a5d5924c41a5d5924c41a5d5924c41a5d5924c41a5d5924c41a5d5924c41a5d5924c41a5d5924c41a5d5924c41a5d5924c41a5d5924c41a5d5924c41a5d5924c41a5d5924c41a5d5924c41a5d5924c41a5d5924c41a5d5924c41a5d5924c41a5d5924c41a5d5924c41a5d5924c41a5d5924c41a5d5924c41a5d5924c41a5d5924c41a5d5924c41a5d5924c41a5d5924c41a5d5924c41a5d5924c41a5d5924c41a5d5924c41a5d5924c41a5d5924c41a5d5924c41a5d5924c41a5d5924c41a5d5924c41a5d5924c41a5d5924c41a5d5924c41a5d5924c41a5d5924c41a5d5924c"),
]

def main():
    print(f"Подключаюсь к {PORT}...")
    try:
        ser = serial.Serial(PORT, BAUDRATE, timeout=1)
    except Exception as e:
        print(f"Ошибка: {e}")
        return

    ser.dtr = False; time.sleep(0.1)
    ser.dtr = True;  time.sleep(0.5)

    # Handshake - один раз
    print("Handshake...")
    for pkt in HANDSHAKE:
        ser.write(pkt)
        time.sleep(0.002)
    time.sleep(0.2)

    # Зацикливаем красный
    print("Красный цвет! Ctrl+C для выхода")
    frame = 0
    try:
        while True:
            for pkt in RED_CYCLE:
                ser.write(pkt)
                if len(pkt) > 100:
                    time.sleep(0.005)
                else:
                    time.sleep(0.001)
            frame += 1
            if frame % 20 == 0:
                print(f"  {frame} циклов...")
    except KeyboardInterrupt:
        print("Стоп.")
    finally:
        ser.close()

if __name__ == "__main__":
    main()